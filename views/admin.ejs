<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova Admin | God Mode</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --gold: #D4AF37; --dark: #0b0e11; --panel: #1e2329; --border: #2b3139; --text: #eaecef; }
        
        body { background: var(--dark); color: var(--text); font-family: 'DINPro', sans-serif; margin: 0; padding: 20px; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 20px; }
        .logo { color: var(--gold); font-size: 24px; font-weight: bold; text-decoration: none; }
        .logout { color: #f6465d; text-decoration: none; font-size: 14px; border: 1px solid #f6465d; padding: 5px 15px; border-radius: 4px; }

        .section-title { color: var(--gold); font-size: 18px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        
        /* RESPONSIVE GRID */
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 40px; }

        /* USER CARDS (Mobile Friendly) */
        .user-card { background: var(--panel); border: 1px solid var(--border); border-radius: 8px; padding: 20px; }
        .user-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 14px; }
        .user-row span:first-child { color: #848e9c; }
        .status-badge { padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; }
        .online { background: rgba(14, 203, 129, 0.15); color: #0ecb81; }
        .offline { background: rgba(132, 142, 156, 0.15); color: #848e9c; }

        /* TRANSACTION LIST */
        .tx-list { display: flex; flex-direction: column; gap: 15px; }
        .tx-card { background: var(--panel); border: 1px solid var(--border); border-radius: 8px; padding: 20px; display: flex; flex-direction: column; gap: 10px; position: relative; overflow: hidden; }
        
        /* Status Color Bars */
        .tx-card.pending { border-left: 4px solid #f0b90b; }
        .tx-card.approved { border-left: 4px solid #0ecb81; }
        .tx-card.rejected { border-left: 4px solid #f6465d; }

        .tx-header { display: flex; justify-content: space-between; align-items: center; }
        .tx-type { font-weight: bold; font-size: 16px; text-transform: uppercase; }
        .tx-amount { font-family: 'Roboto Mono'; font-size: 18px; color: var(--gold); }
        
        .tx-details { font-size: 13px; color: #848e9c; line-height: 1.6; }
        
        /* ACTION BUTTONS */
        .actions { display: flex; gap: 10px; margin-top: 10px; }
        .btn { flex: 1; border: none; padding: 12px; border-radius: 4px; font-weight: bold; cursor: pointer; color: white; font-size: 14px; }
        .btn-approve { background: #0ecb81; }
        .btn-reject { background: #f6465d; }
        
        /* DESKTOP TWEAKS */
        @media (min-width: 768px) {
            .tx-card { flex-direction: row; align-items: center; justify-content: space-between; }
            .tx-list { display: grid; grid-template-columns: 1fr; }
            .actions { margin-top: 0; width: 200px; }
        }
    </style>
</head>
<body>

    <div class="header">
        <a href="#" class="logo">NOVA ADMIN</a>
        <a href="/logout" class="logout">Logout</a>
    </div>

    <div class="section-title"><i class="fas fa-users"></i> Active Clients (<%= users.length %>)</div>
    <div class="grid-container">
        <% users.forEach(u => { %>
            <% if(!u.email.includes('@nova.com')) { %>
            <div class="user-card">
                <div class="user-row">
                    <span>Name</span>
                    <span style="font-weight:bold; color:white;"><%= u.name %></span>
                </div>
                <div class="user-row">
                    <span>Email</span>
                    <span><%= u.email %></span>
                </div>
                <div class="user-row">
                    <span>Balance</span>
                    <span style="color: #0ecb81; font-family:'Roboto Mono';">$<%= u.balance.toFixed(2) %></span>
                </div>
                <div class="user-row">
                    <span>Status</span>
                    <span class="status-badge <%= u.isOnline ? 'online' : 'offline' %>">
                        <%= u.isOnline ? 'ONLINE' : 'OFFLINE' %>
                    </span>
                </div>
            </div>
            <% } %>
        <% }) %>
    </div>

    <div class="section-title"><i class="fas fa-exchange-alt"></i> Transaction Requests</div>
    <div class="tx-list">
        <% transactions.forEach(t => { %>
            <div class="tx-card <%= t.status %>">
                <div style="flex:1;">
                    <div class="tx-header">
                        <span class="tx-type" style="color: <%= t.type == 'deposit' ? '#0ecb81' : '#f6465d' %>"><%= t.type %></span>
                        <span class="tx-amount">$<%= t.amount.toFixed(2) %></span>
                    </div>
                    <div class="tx-details">
                        User ID: <%= t.userId.substring(0,8) %>...<br>
                        Method: <%= t.method %><br>
                        Status: <span style="text-transform:uppercase; font-weight:bold;"><%= t.status %></span>
                    </div>
                </div>

                <% if(t.status === 'pending') { %>
                <div class="actions">
                    <form action="/admin/approve" method="POST" style="flex:1; margin:0;">
                        <input type="hidden" name="userId" value="<%= t.userId %>">
                        <input type="hidden" name="amount" value="<%= t.amount %>">
                        <button class="btn btn-approve">Approve</button>
                    </form>
                    <form action="/admin/reject" method="POST" style="flex:1; margin:0;">
                        <input type="hidden" name="userId" value="<%= t.userId %>">
                        <input type="hidden" name="amount" value="<%= t.amount %>">
                        <button class="btn btn-reject">Reject</button>
                    </form>
                </div>
                <% } %>
            </div>
        <% }) %>
    </div>

</body>
</html>